<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Admin - QuizMaster</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/admin.css">
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">üß† QuizMaster Admin</div>
            <ul class="nav-links">
                <li><a href="../index.html">Startseite</a></li>
                <li><a href="#dashboard">Dashboard</a></li>
                <li><a href="#create-quiz">Quiz erstellen</a></li>
                <li><a href="#my-quizzes">Meine Quiz</a></li>
                <li><button id="theme-toggle" class="theme-toggle">üåô Dunkler Modus</button></li>
            </ul>
        </nav>
    </header>

    <!-- Login Section -->
    <section id="login-section" class="login-section active">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <h1>üß† Quiz Admin Login</h1>
                    <p>Melden Sie sich an, um Ihre Quizzes zu verwalten</p>
                </div>
                
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">Anmelden</button>
                    <button class="auth-tab" data-tab="register">Registrieren</button>
                </div>

                <!-- Login Form -->
                <form id="login-form" class="auth-form active">
                    <div class="form-group">
                        <label for="login-username">Benutzername</label>
                        <input type="text" id="login-username" name="username" required 
                               placeholder="Ihr Benutzername">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Passwort</label>
                        <input type="password" id="login-password" name="password" required 
                               placeholder="Ihr Passwort">
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="remember-me">
                            <span class="checkmark"></span>
                            Angemeldet bleiben
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Anmelden</button>
                    <div class="auth-message" id="login-message"></div>
                </form>

                <!-- Register Form -->
                <form id="register-form" class="auth-form">
                    <div class="form-group">
                        <label for="register-username">Benutzername *</label>
                        <input type="text" id="register-username" name="username" required 
                               placeholder="W√§hlen Sie einen Benutzernamen"
                               pattern="[a-zA-Z0-9_-]{3,20}"
                               title="3-20 Zeichen, nur Buchstaben, Zahlen, _ und -">
                    </div>
                    <div class="form-group">
                        <label for="register-email">E-Mail *</label>
                        <input type="email" id="register-email" name="email" required 
                               placeholder="ihre@email.com">
                    </div>
                    <div class="form-group">
                        <label for="register-password">Passwort *</label>
                        <input type="password" id="register-password" name="password" required 
                               minlength="6" placeholder="Mindestens 6 Zeichen">
                        <div class="password-strength">
                            <div class="password-strength-bar"></div>
                        </div>
                        <small class="help-text">Mindestens 6 Zeichen erforderlich</small>
                    </div>
                    <div class="form-group">
                        <label for="register-confirm-password">Passwort best√§tigen *</label>
                        <input type="password" id="register-confirm-password" name="confirmPassword" required 
                               placeholder="Passwort wiederholen">
                    </div>
                    <div class="form-group">
                        <label for="register-display-name">Anzeigename</label>
                        <input type="text" id="register-display-name" name="displayName" 
                               placeholder="Ihr Name (optional)">
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Registrieren</button>
                    <div class="auth-message" id="register-message"></div>
                </form>
            </div>
        </div>
    </section>

    <main class="admin-main" style="display: none;">
        <div class="container">
            <!-- User Info Header -->
            <div class="user-header">
                <div class="user-info">
                    <span class="user-greeting">Willkommen, <strong id="user-display-name"></strong>!</span>
                    <span class="user-stats" id="user-stats"></span>
                </div>
                <div class="user-actions">
                    <button class="btn btn-outline btn-sm" id="user-profile-btn">üë§ Profil</button>
                    <button class="btn btn-outline btn-sm" id="logout-btn">üö™ Abmelden</button>
                </div>
            </div>

            <!-- Dashboard Section -->
            <section id="dashboard" class="admin-section active">
                <div class="section-header">
                    <h1>Quiz Dashboard</h1>
                    <button class="btn btn-primary" onclick="showSection('create-quiz')">
                        ‚ûï Neues Quiz erstellen
                    </button>
                </div>

                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-content">
                            <h3 id="total-quizzes">0</h3>
                            <p>Gesamt Quiz</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-content">
                            <h3 id="total-participants">0</h3>
                            <p>Gesamt Teilnehmer</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-content">
                            <h3 id="avg-score">0%</h3>
                            <p>Durchschnittswertung</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-content">
                            <h3 id="published-quizzes">0</h3>
                            <p>Ver√∂ffentlichte Quiz</p>
                        </div>
                    </div>
                </div>

                <div class="recent-activity">
                    <h2>Letzte Aktivit√§ten</h2>
                    <div class="activity-list" id="activity-list">
                        <!-- Activity items will be populated by JavaScript -->
                    </div>
                </div>
            </section>

            <!-- Create Quiz Section -->
            <section id="create-quiz" class="admin-section">
                <div class="section-header">
                    <h1>Neues Quiz erstellen</h1>
                    <button class="btn btn-secondary" onclick="showSection('dashboard')">
                        ‚Üê Zur√ºck zum Dashboard
                    </button>
                </div>

                <form id="quiz-form" class="quiz-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="quiz-title">Quiz-Titel *</label>
                            <input type="text" id="quiz-title" name="title" required 
                                   placeholder="Quiz-Titel eingeben">
                        </div>
                        <div class="form-group">
                            <label for="quiz-name">Quiz-Name * (f√ºr Teilnehmer)</label>
                            <input type="text" id="quiz-name" name="quizName" required 
                                   placeholder="z.B. 'mathe-test-2024'" 
                                   pattern="[a-zA-Z0-9-_]+"
                                   title="Nur Buchstaben, Zahlen, Bindestriche und Unterstriche erlaubt">
                            <small class="help-text">Eindeutiger Name, den Teilnehmer zum Beitreten verwenden</small>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="quiz-category">Kategorie</label>
                            <select id="quiz-category" name="category">
                                <option value="general">Allgemeinwissen</option>
                                <option value="science">Wissenschaft</option>
                                <option value="history">Geschichte</option>
                                <option value="sports">Sport</option>
                                <option value="technology">Technologie</option>
                                <option value="arts">Kunst & Literatur</option>
                                <option value="geography">Geografie</option>
                                <option value="custom">Benutzerdefiniert</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="quiz-description">Beschreibung</label>
                        <textarea id="quiz-description" name="description" rows="3" 
                                  placeholder="Kurze Beschreibung Ihres Quiz"></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="quiz-difficulty">Schwierigkeit</label>
                            <select id="quiz-difficulty" name="difficulty">
                                <option value="easy">Einfach</option>
                                <option value="medium">Mittel</option>
                                <option value="hard">Schwer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="quiz-time-limit">Zeitlimit (Minuten)</label>
                            <input type="number" id="quiz-time-limit" name="timeLimit" 
                                   min="1" max="180" value="10">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="quiz-shuffle" name="shuffleQuestions">
                            <span class="checkmark"></span>
                            Fragen mischen
                        </label>
                    </div>

                    <!-- Participant Management Section -->
                    <div class="participants-section">
                        <div class="section-header">
                            <h2>Teilnehmer-Verwaltung</h2>
                            <button type="button" class="btn btn-outline" id="add-participant-btn">
                                üë§ Teilnehmer hinzuf√ºgen
                            </button>
                        </div>
                        
                        <div class="participant-options">
                            <label class="checkbox-label">
                                <input type="checkbox" id="allow-open-registration" name="allowOpenRegistration" checked>
                                <span class="checkmark"></span>
                                Offene Registrierung erlauben (jeder kann beitreten)
                            </label>
                        </div>
                        
                        <div id="participants-container">
                            <div class="participants-list">
                                <div class="participant-header">
                                    <span>Teilnehmer Name</span>
                                    <span>Status</span>
                                    <span>Aktionen</span>
                                </div>
                                <div id="participant-list-items">
                                    <!-- Participants will be added dynamically -->
                                    <div class="empty-participants">
                                        <p>Noch keine Teilnehmer hinzugef√ºgt</p>
                                        <p><small>Aktivieren Sie "Offene Registrierung" oder f√ºgen Sie spezifische Teilnehmer hinzu</small></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="questions-section">
                        <div class="section-header">
                            <h2>Fragen</h2>
                            <button type="button" class="btn btn-outline" id="add-question-btn">
                                ‚ûï Frage hinzuf√ºgen
                            </button>
                        </div>
                        <div id="questions-container">
                            <!-- Questions will be added dynamically -->
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="save-draft-btn">
                            üíæ Als Entwurf speichern
                        </button>
                        <button type="button" class="btn btn-primary" id="publish-quiz-btn">
                            üöÄ Quiz ver√∂ffentlichen
                        </button>
                    </div>
                </form>
            </section>

            <!-- My Quizzes Section -->
            <section id="my-quizzes" class="admin-section">
                <div class="section-header">
                    <h1>Meine Quiz</h1>
                    <div class="quiz-filters">
                        <select id="quiz-filter" class="filter-select">
                            <option value="all">Alle Quiz</option>
                            <option value="published">Ver√∂ffentlicht</option>
                            <option value="draft">Entw√ºrfe</option>
                        </select>
                        <input type="search" id="quiz-search" class="search-input" 
                               placeholder="Quiz suchen...">
                    </div>
                </div>

                <div class="quiz-grid" id="quiz-grid">
                    <!-- Quiz cards will be populated by JavaScript -->
                </div>
            </section>
        </div>
    </main>

    <!-- Question Template (Hidden) -->
    <template id="question-template">
        <div class="question-card">
            <div class="question-header">
                <h3>Frage <span class="question-number"></span></h3>
                <button type="button" class="btn-icon btn-danger remove-question">üóëÔ∏è</button>
            </div>
            <div class="question-content">
                <div class="form-group">
                    <label>Fragetext *</label>
                    <textarea class="question-text" rows="2" required 
                              placeholder="Geben Sie Ihre Frage ein"></textarea>
                </div>
                <div class="form-group">
                    <label>Fragetyp</label>
                    <select class="question-type">
                        <option value="multiple-choice">Multiple Choice</option>
                        <option value="true-false">Wahr/Falsch</option>
                        <option value="short-answer">Kurze Antwort</option>
                    </select>
                </div>
                <div class="answers-container">
                    <!-- Answer options will be populated based on question type -->
                </div>
                <div class="form-group">
                    <label>Punkte</label>
                    <input type="number" class="question-points" min="1" max="10" value="1">
                </div>
            </div>
        </div>
    </template>

    <!-- Quiz Card Template (Hidden) -->
    <template id="quiz-card-template">
        <div class="quiz-card">
            <div class="quiz-card-header">
                <h3 class="quiz-title"></h3>
                <span class="quiz-status"></span>
            </div>
            <div class="quiz-card-content">
                <p class="quiz-description"></p>
                <div class="quiz-name-display">
                    <small><strong>Quiz-Name:</strong> <span class="quiz-name"></span></small>
                </div>
                <div class="quiz-meta">
                    <span class="quiz-category"></span>
                    <span class="quiz-difficulty"></span>
                    <span class="quiz-questions-count"></span>
                </div>
                <div class="quiz-stats">
                    <span class="quiz-participants">üë• <span class="count">0</span> Teilnehmer</span>
                    <span class="quiz-avg-score">‚≠ê <span class="score">0%</span> √ò-Wertung</span>
                </div>
            </div>
            <div class="quiz-card-actions">
                <button class="btn btn-outline btn-sm edit-quiz">‚úèÔ∏è Bearbeiten</button>
                <button class="btn btn-outline btn-sm view-stats">üìä Statistiken</button>
                <button class="btn btn-success btn-sm start-live-btn" style="display: none;">üöÄ Live starten</button>
                <button class="btn btn-primary btn-sm share-quiz">üîó Teilen</button>
                <button class="btn btn-danger btn-sm delete-quiz">üóëÔ∏è L√∂schen</button>
            </div>
        </div>
    </template>

    <!-- Modal for Quiz Statistics -->
    <div id="stats-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Quiz-Statistiken</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="stats-grid">
                    <div class="stat-item">
                        <h3 id="modal-participants">0</h3>
                        <p>Gesamt Teilnehmer</p>
                    </div>
                    <div class="stat-item">
                        <h3 id="modal-avg-score">0%</h3>
                        <p>Durchschnittswertung</p>
                    </div>
                    <div class="stat-item">
                        <h3 id="modal-completion-rate">0%</h3>
                        <p>Abschlussrate</p>
                    </div>
                    <div class="stat-item">
                        <h3 id="modal-avg-time">0m</h3>
                        <p>Durchschnittszeit</p>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="score-chart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="share-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Quiz teilen</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="share-options">
                    <div class="form-group">
                        <label>Quiz-Link</label>
                        <div class="input-with-copy">
                            <input type="text" id="quiz-link" readonly>
                            <button class="btn btn-outline copy-link">üìã Kopieren</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Einbettungscode</label>
                        <div class="input-with-copy">
                            <textarea id="embed-code" rows="3" readonly></textarea>
                            <button class="btn btn-outline copy-embed">üìã Kopieren</button>
                        </div>
                    </div>
                    <div class="share-buttons">
                        <button class="btn btn-social twitter">üê¶ Twitter</button>
                        <button class="btn btn-social facebook">üìò Facebook</button>
                        <button class="btn btn-social email">üìß E-Mail</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script type="module" src="../js/main.js"></script>
    <script type="module" src="../js/admin.js"></script>
</body>
</html>
